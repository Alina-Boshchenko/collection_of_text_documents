Минимизация  функции многих переменных   прямыми методами.

Цель работы: знакомство с задачей  минимизации  функции многих переменных   методами, не требующими вычисления градиента  функции. К ним относятся  метод покоординатного спуска, метод деформированного многогранника. 
Введение. Данная задача формулируется как задача безусловной оптимизации, сутью которой является поиск минимума функции многих переменных на всем пространстве соответствующей размерности. Функцию многих переменных    будем рассматривать как функцию, заданную в точках X n-мерного эвклидова пространства En.
Рассмотрим основные методы решения задач безусловной минимизации вида:
                                              где   	 (1.1.)

Если функция  дважды дифференцируема, то данную задачу можно решить аналитически, используя необходимые и достаточные условия безусловного экстремума. Записав необходимые условия:
                                     или   	(1.2)
находим все стационарные точки функции  . Среди них, используя достаточные условия, находим точки локального минимума, в которых матрица вторых производных  положительно определена. Сравнивая значения в этих точках, находим точку глобально минимума.
Однако аналитически решить систему уравнений (1.2) не всегда возможно. Кроме того, функция  может быть не только недифференцируемой, но даже не аналитически заданной. Поэтому аналитический метод имеет ограниченное применение и для решения задачи (1.1) на практике чаще используют приближенные численные методы.
Простейшие из них, называемые прямыми методами, не требуют вычисления производных функций  , а используют только вычисленное значение функции  .
В этих методах, после задания начальной точки   последовательно ищутся точки   такие, чтобы выполнялось неравенство вида:
                                 	(1.3)

Новая точка   ищется с помощью итерационной процедуры вида:
                                               	(1.4),
в которой выбор нового приближения к точке минимума определяется сравнением значений функции  в нескольких точках пространства En.

1.	Постановка задачи.
Дана функция y=f(X) . Требуется найти минимум функции, используя  метод покоординатного спуска или метод деформированного многогранника. 


2.	Метод покоординатного спуска.

При оптимизации по данному методу траектория поиска экстремума функции   выбирается в виде ломаной линии, отдельные отрезки которой параллельны координатным осям пространства оптимизируемых параметров  .
В случае n=2 можно на примере линий равного уровня, то есть геометрического места точек, в которых соблюдается условие  , показать данную траекторию.


 

Рис. 1

Опишем данный метод.
После выбора некоторого начального приближения  ищется   при фиксированных значениях  . Таким образом, движение из точки   происходит по прямой, параллельной оси   в сторону убывания функции      . Затем поиск идет вдоль оси   из точки с координатами  , то есть ищется  . Описанная процедура последовательно повторяется для всех  .
По завершению поиска по всем   получаем точку  . Процесс поиска повторяется аналогично вышеизложенному, и в результате имеем точку   и так далее. Итерационный процесс поиска заканчивается, когда изменение аргумента X мало влияет на изменение функции  , то есть выполняется следующее неравенство вида:
                                           	(1.5),
где  -заданная точность вычислений.
Примечание. При поиске минимума функции  по направлению вдоль оси  ,  переход от начальной точки   к точке   происходит в соответствии с формулой:
	 	(1.6),
где параметр   может принимать значение 1 или -1, а  -величина шага в данном направлении. При отыскании   коэффициент   меняется от начального значения  до минимально возможного  .


3.  Алгоритм метода покоординатного спуска.

1.	Задается точность вычисления  , начальный шаг  , минимально допустимый шаг  , точка начального приближения  , порядковый номер итерации k=0 и вычисляется . 
2.	Запоминаем   .
3.	 Начинаем поиск параллельно оси Охi  : ,если  , переходим к п. 11 , иначе к п. 4.
4.	Задаем шаг  . 
5.	Задаем знак  .
6.	Вычисляем   в соответствии с формулой (1.6)  и значение функции в новой точке. 
7.	Если новое значение функции меньше предыдущего, то принимаем    как , запоминаем как     и возвращаемся к п. 6, иначе меняем знак   на противоположный.
8.	Если знак  ,то переходим к п. 6, иначе к п. 9.
9.	 Уменьшим величину шага  .
10.	Если текущий шаг  , то переходим к п. 3, иначе к п. 5.
11.	Проверка условия достижения заданной точности:  и если оно выполняется, то переходим к п. 12, иначе  к п. 2.
12.	Завершить вычисления, приняв за точку минимума последнее значение Хk, 

4.  Текст программы.

Смотри приложение №1.

5.	Метод деформируемого многогранника (метод Нелдера — Мида).

Метод Нелдера — Мида, также известный как метод деформируемого многогранника и симплекс-метод, — метод безусловной оптимизации функции от нескольких переменных, не использующий   градиентов функции, а поэтому легко применим к негладким и/или зашумлённым функциям.
            В методе Нелдера и Мида минимизируется функция n независимых переменных с использованием n+1 вершин деформируемого многогранника в En. Каждая вершина может быть идентифицирована вектором x. Вершина (точка) в En, в которой значение f(x) максимально, проектируется через центр тяжести (центроид) оставшихся вершин. Улучшенные (более низкие) значения целевой функции находятся последовательной заменой точки с максимальным значением f(x) на более «хорошие точки», пока не будет найден минимум f(x).
Суть метода заключается в последовательном перемещении и деформировании симплекса вокруг точки экстремума.  Предполагается, что серьёзных ограничений на область определения функции нет, то есть функция определена во всех встречающихся точках.
Параметрами метода являются:
•	коэффициент отражения α > 0, обычно выбирается равным 1.
•	коэффициент сжатия β > 0, обычно выбирается равным 0,5.
•	коэффициент растяжения γ > 0, обычно выбирается равным 2.

6.  Алгоритм метода.
	Пусть  , является i-й вершиной (точкой) в En на k-м этапе поиска, k=0, 1, …, и пусть значение целевой функции в x(k)i равно f(x(k)i). Кроме того, отметим те векторы x многогранника, которые дают максимальное и минимальное значения f(x).

	Определим
 
 
 
  Поскольку многогранник в En состоит из (n+1) вершин x1, …,xn+1, пусть xn+2 будет центром тяжести всех вершин, исключая xh.

	Тогда координаты этого центра определяются формулой
 			(1.7)
где индекс j обозначает координатное направление.

	Начальный многогранник обычно выбирается в виде регулярного симплекса (но это не обязательно) с точкой 1 в качестве начала координат; можно начало координат поместить в центр тяжести. Процедура отыскания вершины в En, в которой f(x) имеет лучшее значение, состоит из следующих операций:

1.	Отражение – проектирование   через центр тяжести в соответствии с соотношением
 		 					(1.8)
где >0 является коэффициентом отражения;   – центр тяжести, вычисляемый по формуле (1);   – вершина, в которой функция f(x) принимает наибольшее из n+1 значений на k-м этапе.
	
2.	Растяжение. Эта операция заключается в следующем: если  , то вектор   растягивается в соответствии с соотношением
 		 					(1.9)
где >1 представляет собой коэффициент растяжения. Если  , то   заменяется на   и процедура продолжается снова с операции 1 при k=k+1. В противном случае   заменяется на   и также осуществляется переход к операции 1 при k=k+1.
	
3.	Сжатие. Если   для всех ih, то вектор   сжимается в соответствии с формулой
 		 					(1.10)
где 0<<1 представляет собой коэффициент сжатия. Затем   заменяем на   и возвращаемся к операции 1 для продолжения поиска на (k+1)-м шаге.
	
4.	Редукция. Если  , все векторы   уменьшаются в 2 раза с отсчётом от   в соответствии с формулой
 		 		(1.11)

Затем возвращаемся к операции 1 для продолжения поиска на (k+1)-м шаге.


	Критерий окончания поиска, использованный Нелдером и Мидом, состоял в проверке условия

